---
layout: post
title: PHP 简单的登录与注册
author: zrg
comments: false
description: PHP 登录与注册实现
categories:
- PHP
tags:
- PHP
photos:
---

<div id="outline-container-org5941f6e" class="outline-2">
<h2 id="org5941f6e">登录与注册</h2>
<div class="outline-text-2" id="text-org5941f6e">
</div>
<div id="outline-container-org546e058" class="outline-3">
<h3 id="org546e058">简单的登录示例</h3>
<div class="outline-text-3" id="text-org546e058">
</div>
<div id="outline-container-org16888c1" class="outline-4">
<h4 id="org16888c1">login.html</h4>
<div class="outline-text-4" id="text-org16888c1">
<div class="org-src-container">
<pre class="src src-sh">&lt;form <span style="color: #b35000;">name</span>=<span style="color: #5c3566;">"loginform"</span> <span style="color: #b35000;">method</span>=<span style="color: #5c3566;">"post"</span> <span style="color: #b35000;">action</span>=<span style="color: #5c3566;">"login-fun.php"</span> <span style="color: #b35000;">onsubmit</span>=<span style="color: #5c3566;">"return InputCheck(this)"</span>&gt;
  &lt;input <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"span12"</span> <span style="color: #b35000;">type</span>=<span style="color: #5c3566;">"text"</span> <span style="color: #b35000;">name</span>=<span style="color: #5c3566;">"username"</span> <span style="color: #b35000;">id</span>=<span style="color: #5c3566;">"username"</span> <span style="color: #b35000;">placeholder</span>=<span style="color: #5c3566;">"Username"</span> /&gt;
   &lt;input <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"span12"</span> <span style="color: #b35000;">type</span>=<span style="color: #5c3566;">"password"</span> <span style="color: #b35000;">name</span>=<span style="color: #5c3566;">"password"</span> <span style="color: #b35000;">id</span>=<span style="color: #5c3566;">"password"</span> <span style="color: #b35000;">placeholder</span>=<span style="color: #5c3566;">"Password"</span> /&gt;
   &lt;a <span style="color: #b35000;">href</span>=<span style="color: #5c3566;">"mailto:1390556487@qq.com?subject=Hello, administrator, I forgot my password."</span> <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"forgot"</span>&gt;
   &#24536;&#35760;&#23494;&#30721;,&#32852;&#31995;&#31649;&#29702;&#21592;&lt;/a&gt;
     &lt;div <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"remember"</span>&gt;
     &lt;input <span style="color: #b35000;">id</span>=<span style="color: #5c3566;">"remember-me"</span> <span style="color: #b35000;">type</span>=<span style="color: #5c3566;">"checkbox"</span> /&gt;
     &lt;label <span style="color: #b35000;">for</span>=<span style="color: #5c3566;">"remember-me"</span>&gt;&#35760;&#20303;&#23494;&#30721;&lt;/label&gt;
   &lt;/div&gt;
   &lt;input <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"btn-glow primary login"</span> <span style="color: #b35000;">type</span>=<span style="color: #5c3566;">"submit"</span> <span style="color: #b35000;">name</span>=<span style="color: #5c3566;">"submit"</span> <span style="color: #b35000;">value</span>=<span style="color: #5c3566;">"&#30331;&#24405;"</span> <span style="color: #b35000;">onclick</span>=<span style="color: #5c3566;">"check()"</span> /&gt;
 &lt;/form&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-orga6dd1c0" class="outline-4">
<h4 id="orga6dd1c0">login-fun.php</h4>
<div class="outline-text-4" id="text-orga6dd1c0">
<div class="org-src-container">
<pre class="src src-sh">&lt;?php
/**
 * &#30331;&#24405;
 */
<span style="color: #346604;">if</span>(!isset($<span style="color: #b35000;">_POST</span>[<span style="color: #5c3566;">'submit'</span>])){  
    <span style="color: #346604;">exit</span>(<span style="color: #5c3566;">'&#38750;&#27861;&#35775;&#38382;!'</span>);  
} 
<span style="color: #a40000;">include</span>(<span style="color: #5c3566;">"conn/conn.php"</span>);   //&#24341;&#20837;&#25968;&#25454;&#24211;&#36830;&#25509;&#25991;&#20214;
$<span style="color: #b35000;">username</span> = htmlspecialchars($<span style="color: #b35000;">_POST</span>[<span style="color: #5c3566;">'username'</span>]);
$<span style="color: #b35000;">password</span> = MD5($<span style="color: #b35000;">_POST</span>[<span style="color: #5c3566;">'password'</span>]); 
$<span style="color: #b35000;">select</span>=mysqli_query($<span style="color: #b35000;">conn</span>,<span style="color: #5c3566;">"SELECT Id from es_admin where AdminName='$username' and Password='$password'"</span>);
<span style="color: #346604;">if</span>($<span style="color: #b35000;">result</span> = mysqli_fetch_array($<span style="color: #b35000;">select</span>)){
    //&#30331;&#24405;&#25104;&#21151;  
    session_start();  
    $<span style="color: #b35000;">_SESSION</span>[<span style="color: #5c3566;">'username'</span>] = $<span style="color: #b35000;">username</span>;  
    $<span style="color: #b35000;">_SESSION</span>[<span style="color: #5c3566;">'password'</span>] = $<span style="color: #b35000;">password</span>;
    $<span style="color: #b35000;">_SESSION</span>[<span style="color: #5c3566;">'Id'</span>]=$<span style="color: #b35000;">result</span>[<span style="color: #5c3566;">'Id'</span>];  
    <span style="color: #75507b;">echo</span> <span style="color: #5c3566;">"&lt;script&gt;window.location.href='index.php';&lt;/script&gt;"</span>;
} <span style="color: #346604;">else</span> {  
// &#30331;&#24405;&#22833;&#36133;
<span style="color: #75507b;">echo</span> <span style="color: #5c3566;">"&lt;script&gt;alert('&#30331;&#24405;&#22833;&#36133;!');window.location.href=\"signin.php\";&lt;/script&gt;"</span>;
}  
?&gt;
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-orgd7784d3" class="outline-3">
<h3 id="orgd7784d3">应用在ThinkPHP 3.2.3中</h3>
<div class="outline-text-3" id="text-orgd7784d3">
</div>
<div id="outline-container-org444cea2" class="outline-4">
<h4 id="org444cea2">login.html</h4>
<div class="outline-text-4" id="text-org444cea2">
<div class="org-src-container">
<pre class="src src-sh">&lt;form <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"login-form"</span> <span style="color: #b35000;">action</span>=<span style="color: #5c3566;">"{:U('Home/Login/login','','')}"</span> <span style="color: #b35000;">method</span>=<span style="color: #5c3566;">"post"</span>&gt;
   &lt;span&gt;
   &#35831;&#36755;&#20837;&#29992;&#25143;&#21517;&#21644;&#23494;&#30721;. &lt;/span&gt;
   &lt;/div&gt;
   &lt;div <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"form-group"</span>&gt;
   &lt;!--ie8, ie9 does not support html5 placeholder, so we just show field title for that--&gt;
   &lt;label <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"control-label visible-ie8 visible-ie9"</span>&gt;&#29992;&#25143;&#21517;&lt;/label&gt;
   &lt;div <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"input-icon"</span>&gt;
    &lt;i <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"fa fa-user"</span>&gt;&lt;/i&gt;
    &lt;input <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"form-control placeholder-no-fix"</span> <span style="color: #b35000;">type</span>=<span style="color: #5c3566;">"text"</span> <span style="color: #b35000;">autocomplete</span>=<span style="color: #5c3566;">"off"</span> <span style="color: #b35000;">placeholder</span>=<span style="color: #5c3566;">"&#29992;&#25143;&#21517;"</span> <span style="color: #b35000;">name</span>=<span style="color: #5c3566;">"username"</span>/&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"form-group"</span>&gt;
    &lt;label <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"control-label visible-ie8 visible-ie9"</span>&gt;&#23494;&#30721;&lt;/label&gt;
    &lt;div <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"input-icon"</span>&gt;
    &lt;i <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"fa fa-lock"</span>&gt;&lt;/i&gt;
    &lt;input <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"form-control placeholder-no-fix"</span> <span style="color: #b35000;">type</span>=<span style="color: #5c3566;">"password"</span> <span style="color: #b35000;">autocomplete</span>=<span style="color: #5c3566;">"off"</span> <span style="color: #b35000;">placeholder</span>=<span style="color: #5c3566;">"&#23494;&#30721;"</span> <span style="color: #b35000;">name</span>=<span style="color: #5c3566;">"password"</span>/&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"form-group"</span>&gt;
    &lt;div <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"input-icon"</span> <span style="color: #b35000;">id</span>=<span style="color: #5c3566;">"code"</span>&gt;
    &lt;input <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"form-control placeholder-no-fix"</span> <span style="color: #b35000;">type</span>=<span style="color: #5c3566;">"code"</span> <span style="color: #b35000;">utocomplete</span>=<span style="color: #5c3566;">"off"</span> <span style="color: #b35000;">placeholder</span>=<span style="color: #5c3566;">"&#39564;&#35777;&#30721;"</span> <span style="color: #b35000;">name</span>=<span style="color: #5c3566;">"verify"</span> /&gt;&lt;img <span style="color: #b35000;">id</span>=<span style="color: #5c3566;">"code"</span> <span style="color: #b35000;">src</span>=<span style="color: #5c3566;">"{:U('Home/Login/verify','','')}"</span> /&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"form-actions"</span>&gt;
    &lt;label <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"checkbox"</span>&gt;
    &lt;input <span style="color: #b35000;">type</span>=<span style="color: #5c3566;">"checkbox"</span> <span style="color: #b35000;">name</span>=<span style="color: #5c3566;">"remember"</span> <span style="color: #b35000;">value</span>=<span style="color: #5c3566;">"1"</span>/&gt; &#35760;&#20303;&#23494;&#30721; &lt;/label&gt;
    &lt;button <span style="color: #b35000;">type</span>=<span style="color: #5c3566;">"submit"</span> <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"btn green-haze pull-right"</span>&gt;
    &#30331;&#24405; &lt;i <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"m-icon-swapright m-icon-white"</span>&gt;&lt;/i&gt;
    &lt;/button&gt;
    &lt;/div&gt;
    &lt;div <span style="color: #b35000;">class</span>=<span style="color: #5c3566;">"forget-password"</span>&gt;
    &lt;h4&gt;&#24536;&#35760;&#23494;&#30721; ?&lt;/h4&gt;
    &lt;p&gt;
    &#21035;&#25285;&#24515;&#65292;&#28857;&#20987; &lt;a <span style="color: #b35000;">href</span>=<span style="color: #5c3566;">"javascript:;"</span> <span style="color: #b35000;">id</span>=<span style="color: #5c3566;">"forget-password"</span>&gt;
    &#36825;&#20799; &lt;/a&gt;
    &lt;/p&gt;
    &lt;/div&gt;
    &lt;/form&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-org2feb6f0" class="outline-4">
<h4 id="org2feb6f0">LoginController.class.php</h4>
<div class="outline-text-4" id="text-org2feb6f0">
<div class="org-src-container">
<pre class="src src-sh">//&#30331;&#38470;&#39564;&#35777;
  public <span style="color: #346604;">function</span> <span style="color: #a40000;">login</span>(){
   $<span style="color: #b35000;">username</span> = I(<span style="color: #5c3566;">'username'</span>);
   $<span style="color: #b35000;">password</span> = I(<span style="color: #5c3566;">'password'</span>,<span style="color: #5c3566;">''</span>,<span style="color: #5c3566;">'md5'</span>);
   //login check
   $<span style="color: #b35000;">user</span>=M(<span style="color: #5c3566;">'user'</span>)-&gt;where(array(<span style="color: #5c3566;">'username'</span> =&gt; $<span style="color: #b35000;">username</span>))-&gt;find();
   <span style="color: #346604;">if</span> (!$<span style="color: #b35000;">user</span> || $<span style="color: #b35000;">user</span>[<span style="color: #5c3566;">'password'</span>] != $<span style="color: #b35000;">password</span>) {
      $<span style="color: #b35000;">this</span>-&gt;error(<span style="color: #5c3566;">'&#36134;&#21495;&#25110;&#23494;&#30721;&#38169;&#35823;'</span>);
   }

  //login information insert
  $<span style="color: #b35000;">data</span> = array(
  <span style="color: #5c3566;">'id'</span> =&gt; $<span style="color: #b35000;">user</span>[<span style="color: #5c3566;">'id'</span>],
  <span style="color: #5c3566;">'login_time'</span> =&gt; date(<span style="color: #5c3566;">'Y-m-d H:i:s'</span>),
  <span style="color: #5c3566;">'login_ip'</span> =&gt; get_client_ip(),
  );
  M(<span style="color: #5c3566;">'user'</span>)-&gt;save($<span style="color: #b35000;">data</span>);

  //session
  session_start();
  $<span style="color: #b35000;">_SESSION</span>[<span style="color: #5c3566;">'username'</span>]=$<span style="color: #b35000;">username</span>;
  $<span style="color: #b35000;">_SESSION</span>[<span style="color: #5c3566;">'password'</span>]=$<span style="color: #b35000;">password</span>;
  $<span style="color: #b35000;">_SESSION</span>[<span style="color: #5c3566;">'id'</span>]=$<span style="color: #b35000;">user</span>[<span style="color: #5c3566;">'id'</span>];
  $<span style="color: #b35000;">_SESSION</span>[<span style="color: #5c3566;">'login_time'</span>]=time();

  $<span style="color: #b35000;">this</span>-&gt;redirect(<span style="color: #5c3566;">'Home/Index/index'</span>);
  }
</pre>
</div>
</div>
</div>
</div>
</div>
