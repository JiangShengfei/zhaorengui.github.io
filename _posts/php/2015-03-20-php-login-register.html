---
layout: post
title: PHP 简单的登录与注册
author: zrg
comments: false
description: PHP 登录与注册实现
categories:
- PHP
tags:
- PHP
photos:
---

<div id="outline-container-org964b00d" class="outline-2">
<h2 id="org964b00d">登录与注册</h2>
<div class="outline-text-2" id="text-org964b00d">
</div>
<div id="outline-container-org98d8851" class="outline-3">
<h3 id="org98d8851">简单的登录示例</h3>
<div class="outline-text-3" id="text-org98d8851">
</div>
<div id="outline-container-org2fb28da" class="outline-4">
<h4 id="org2fb28da">login.html</h4>
<div class="outline-text-4" id="text-org2fb28da">
<div class="org-src-container">
<pre class="src src-sh">&lt;form <span style="color: #a0522d;">name</span>=<span style="color: #8b2252;">"loginform"</span> <span style="color: #a0522d;">method</span>=<span style="color: #8b2252;">"post"</span> <span style="color: #a0522d;">action</span>=<span style="color: #8b2252;">"login-fun.php"</span> <span style="color: #a0522d;">onsubmit</span>=<span style="color: #8b2252;">"return InputCheck(this)"</span>&gt;
  &lt;input <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"span12"</span> <span style="color: #a0522d;">type</span>=<span style="color: #8b2252;">"text"</span> <span style="color: #a0522d;">name</span>=<span style="color: #8b2252;">"username"</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"username"</span> <span style="color: #a0522d;">placeholder</span>=<span style="color: #8b2252;">"Username"</span> /&gt;
   &lt;input <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"span12"</span> <span style="color: #a0522d;">type</span>=<span style="color: #8b2252;">"password"</span> <span style="color: #a0522d;">name</span>=<span style="color: #8b2252;">"password"</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"password"</span> <span style="color: #a0522d;">placeholder</span>=<span style="color: #8b2252;">"Password"</span> /&gt;
   &lt;a <span style="color: #a0522d;">href</span>=<span style="color: #8b2252;">"mailto:1390556487@qq.com?subject=Hello, administrator, I forgot my password."</span> <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"forgot"</span>&gt;
   &#24536;&#35760;&#23494;&#30721;,&#32852;&#31995;&#31649;&#29702;&#21592;&lt;/a&gt;
     &lt;div <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"remember"</span>&gt;
     &lt;input <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"remember-me"</span> <span style="color: #a0522d;">type</span>=<span style="color: #8b2252;">"checkbox"</span> /&gt;
     &lt;label <span style="color: #a0522d;">for</span>=<span style="color: #8b2252;">"remember-me"</span>&gt;&#35760;&#20303;&#23494;&#30721;&lt;/label&gt;
   &lt;/div&gt;
   &lt;input <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"btn-glow primary login"</span> <span style="color: #a0522d;">type</span>=<span style="color: #8b2252;">"submit"</span> <span style="color: #a0522d;">name</span>=<span style="color: #8b2252;">"submit"</span> <span style="color: #a0522d;">value</span>=<span style="color: #8b2252;">"&#30331;&#24405;"</span> <span style="color: #a0522d;">onclick</span>=<span style="color: #8b2252;">"check()"</span> /&gt;
 &lt;/form&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfb8020a" class="outline-4">
<h4 id="orgfb8020a">login-fun.php</h4>
<div class="outline-text-4" id="text-orgfb8020a">
<div class="org-src-container">
<pre class="src src-sh">&lt;?php
/**
 * &#30331;&#24405;
 */
<span style="color: #a020f0;">if</span>(!isset($<span style="color: #a0522d;">_POST</span>[<span style="color: #8b2252;">'submit'</span>])){  
    <span style="color: #a020f0;">exit</span>(<span style="color: #8b2252;">'&#38750;&#27861;&#35775;&#38382;!'</span>);  
} 
<span style="color: #0000ff;">include</span>(<span style="color: #8b2252;">"conn/conn.php"</span>);   //&#24341;&#20837;&#25968;&#25454;&#24211;&#36830;&#25509;&#25991;&#20214;
$<span style="color: #a0522d;">username</span> = htmlspecialchars($<span style="color: #a0522d;">_POST</span>[<span style="color: #8b2252;">'username'</span>]);
$<span style="color: #a0522d;">password</span> = MD5($<span style="color: #a0522d;">_POST</span>[<span style="color: #8b2252;">'password'</span>]); 
$<span style="color: #a0522d;">select</span>=mysqli_query($<span style="color: #a0522d;">conn</span>,<span style="color: #8b2252;">"SELECT Id from es_admin where AdminName='$username' and Password='$password'"</span>);
<span style="color: #a020f0;">if</span>($<span style="color: #a0522d;">result</span> = mysqli_fetch_array($<span style="color: #a0522d;">select</span>)){
    //&#30331;&#24405;&#25104;&#21151;  
    session_start();  
    $<span style="color: #a0522d;">_SESSION</span>[<span style="color: #8b2252;">'username'</span>] = $<span style="color: #a0522d;">username</span>;  
    $<span style="color: #a0522d;">_SESSION</span>[<span style="color: #8b2252;">'password'</span>] = $<span style="color: #a0522d;">password</span>;
    $<span style="color: #a0522d;">_SESSION</span>[<span style="color: #8b2252;">'Id'</span>]=$<span style="color: #a0522d;">result</span>[<span style="color: #8b2252;">'Id'</span>];  
    <span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"&lt;script&gt;window.location.href='index.php';&lt;/script&gt;"</span>;
} <span style="color: #a020f0;">else</span> {  
// &#30331;&#24405;&#22833;&#36133;
<span style="color: #483d8b;">echo</span> <span style="color: #8b2252;">"&lt;script&gt;alert('&#30331;&#24405;&#22833;&#36133;!');window.location.href=\"signin.php\";&lt;/script&gt;"</span>;
}  
?&gt;
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-org2e0c571" class="outline-3">
<h3 id="org2e0c571">应用在ThinkPHP 3.2.3中</h3>
<div class="outline-text-3" id="text-org2e0c571">
</div>
<div id="outline-container-orge01723d" class="outline-4">
<h4 id="orge01723d">login.html</h4>
<div class="outline-text-4" id="text-orge01723d">
<div class="org-src-container">
<pre class="src src-sh">&lt;form <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"login-form"</span> <span style="color: #a0522d;">action</span>=<span style="color: #8b2252;">"{:U('Home/Login/login','','')}"</span> <span style="color: #a0522d;">method</span>=<span style="color: #8b2252;">"post"</span>&gt;
   &lt;span&gt;
   &#35831;&#36755;&#20837;&#29992;&#25143;&#21517;&#21644;&#23494;&#30721;. &lt;/span&gt;
   &lt;/div&gt;
   &lt;div <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"form-group"</span>&gt;
   &lt;!--ie8, ie9 does not support html5 placeholder, so we just show field title for that--&gt;
   &lt;label <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"control-label visible-ie8 visible-ie9"</span>&gt;&#29992;&#25143;&#21517;&lt;/label&gt;
   &lt;div <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"input-icon"</span>&gt;
    &lt;i <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"fa fa-user"</span>&gt;&lt;/i&gt;
    &lt;input <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"form-control placeholder-no-fix"</span> <span style="color: #a0522d;">type</span>=<span style="color: #8b2252;">"text"</span> <span style="color: #a0522d;">autocomplete</span>=<span style="color: #8b2252;">"off"</span> <span style="color: #a0522d;">placeholder</span>=<span style="color: #8b2252;">"&#29992;&#25143;&#21517;"</span> <span style="color: #a0522d;">name</span>=<span style="color: #8b2252;">"username"</span>/&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"form-group"</span>&gt;
    &lt;label <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"control-label visible-ie8 visible-ie9"</span>&gt;&#23494;&#30721;&lt;/label&gt;
    &lt;div <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"input-icon"</span>&gt;
    &lt;i <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"fa fa-lock"</span>&gt;&lt;/i&gt;
    &lt;input <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"form-control placeholder-no-fix"</span> <span style="color: #a0522d;">type</span>=<span style="color: #8b2252;">"password"</span> <span style="color: #a0522d;">autocomplete</span>=<span style="color: #8b2252;">"off"</span> <span style="color: #a0522d;">placeholder</span>=<span style="color: #8b2252;">"&#23494;&#30721;"</span> <span style="color: #a0522d;">name</span>=<span style="color: #8b2252;">"password"</span>/&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"form-group"</span>&gt;
    &lt;div <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"input-icon"</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"code"</span>&gt;
    &lt;input <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"form-control placeholder-no-fix"</span> <span style="color: #a0522d;">type</span>=<span style="color: #8b2252;">"code"</span> <span style="color: #a0522d;">utocomplete</span>=<span style="color: #8b2252;">"off"</span> <span style="color: #a0522d;">placeholder</span>=<span style="color: #8b2252;">"&#39564;&#35777;&#30721;"</span> <span style="color: #a0522d;">name</span>=<span style="color: #8b2252;">"verify"</span> /&gt;&lt;img <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"code"</span> <span style="color: #a0522d;">src</span>=<span style="color: #8b2252;">"{:U('Home/Login/verify','','')}"</span> /&gt;
    &lt;/div&gt;
    &lt;/div&gt;
    &lt;div <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"form-actions"</span>&gt;
    &lt;label <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"checkbox"</span>&gt;
    &lt;input <span style="color: #a0522d;">type</span>=<span style="color: #8b2252;">"checkbox"</span> <span style="color: #a0522d;">name</span>=<span style="color: #8b2252;">"remember"</span> <span style="color: #a0522d;">value</span>=<span style="color: #8b2252;">"1"</span>/&gt; &#35760;&#20303;&#23494;&#30721; &lt;/label&gt;
    &lt;button <span style="color: #a0522d;">type</span>=<span style="color: #8b2252;">"submit"</span> <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"btn green-haze pull-right"</span>&gt;
    &#30331;&#24405; &lt;i <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"m-icon-swapright m-icon-white"</span>&gt;&lt;/i&gt;
    &lt;/button&gt;
    &lt;/div&gt;
    &lt;div <span style="color: #a0522d;">class</span>=<span style="color: #8b2252;">"forget-password"</span>&gt;
    &lt;h4&gt;&#24536;&#35760;&#23494;&#30721; ?&lt;/h4&gt;
    &lt;p&gt;
    &#21035;&#25285;&#24515;&#65292;&#28857;&#20987; &lt;a <span style="color: #a0522d;">href</span>=<span style="color: #8b2252;">"javascript:;"</span> <span style="color: #a0522d;">id</span>=<span style="color: #8b2252;">"forget-password"</span>&gt;
    &#36825;&#20799; &lt;/a&gt;
    &lt;/p&gt;
    &lt;/div&gt;
    &lt;/form&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-org234a654" class="outline-4">
<h4 id="org234a654">LoginController.class.php</h4>
<div class="outline-text-4" id="text-org234a654">
<div class="org-src-container">
<pre class="src src-sh">//&#30331;&#38470;&#39564;&#35777;
  public <span style="color: #a020f0;">function</span> <span style="color: #0000ff;">login</span>(){
   $<span style="color: #a0522d;">username</span> = I(<span style="color: #8b2252;">'username'</span>);
   $<span style="color: #a0522d;">password</span> = I(<span style="color: #8b2252;">'password'</span>,<span style="color: #8b2252;">''</span>,<span style="color: #8b2252;">'md5'</span>);
   //login check
   $<span style="color: #a0522d;">user</span>=M(<span style="color: #8b2252;">'user'</span>)-&gt;where(array(<span style="color: #8b2252;">'username'</span> =&gt; $<span style="color: #a0522d;">username</span>))-&gt;find();
   <span style="color: #a020f0;">if</span> (!$<span style="color: #a0522d;">user</span> || $<span style="color: #a0522d;">user</span>[<span style="color: #8b2252;">'password'</span>] != $<span style="color: #a0522d;">password</span>) {
      $<span style="color: #a0522d;">this</span>-&gt;error(<span style="color: #8b2252;">'&#36134;&#21495;&#25110;&#23494;&#30721;&#38169;&#35823;'</span>);
   }

  //login information insert
  $<span style="color: #a0522d;">data</span> = array(
  <span style="color: #8b2252;">'id'</span> =&gt; $<span style="color: #a0522d;">user</span>[<span style="color: #8b2252;">'id'</span>],
  <span style="color: #8b2252;">'login_time'</span> =&gt; date(<span style="color: #8b2252;">'Y-m-d H:i:s'</span>),
  <span style="color: #8b2252;">'login_ip'</span> =&gt; get_client_ip(),
  );
  M(<span style="color: #8b2252;">'user'</span>)-&gt;save($<span style="color: #a0522d;">data</span>);

  //session
  session_start();
  $<span style="color: #a0522d;">_SESSION</span>[<span style="color: #8b2252;">'username'</span>]=$<span style="color: #a0522d;">username</span>;
  $<span style="color: #a0522d;">_SESSION</span>[<span style="color: #8b2252;">'password'</span>]=$<span style="color: #a0522d;">password</span>;
  $<span style="color: #a0522d;">_SESSION</span>[<span style="color: #8b2252;">'id'</span>]=$<span style="color: #a0522d;">user</span>[<span style="color: #8b2252;">'id'</span>];
  $<span style="color: #a0522d;">_SESSION</span>[<span style="color: #8b2252;">'login_time'</span>]=time();

  $<span style="color: #a0522d;">this</span>-&gt;redirect(<span style="color: #8b2252;">'Home/Index/index'</span>);
  }
</pre>
</div>
</div>
</div>
</div>
</div>
