---
layout: post
title: C# Notes
author: zrg
comments: false
description: C# 开发笔记
categories:
- C#
tags:
- C#
photos:
---

<div id="outline-container-orgaa4b086" class="outline-2">
<h2 id="orgaa4b086">字符串操作</h2>
<div class="outline-text-2" id="text-orgaa4b086">
</div>
<div id="outline-container-org8390bfa" class="outline-3">
<h3 id="org8390bfa">String.Substring()</h3>
<div class="outline-text-3" id="text-org8390bfa">
<pre class="example">
//格式
String.Substring(int beginIndex)
String.Substring(int beginIndex,int endIndex)
//示例
string str_new=str.Substring(6,2)：表示从str中截取位置为6的字符开始长度为2的字符串，6表示子字符的起始位置，2表示子字符的字符长度。

</pre>
</div>
</div>
<div id="outline-container-org94f1ae7" class="outline-3">
<h3 id="org94f1ae7">其他方法</h3>
<div class="outline-text-3" id="text-org94f1ae7">
<pre class="example">
//格式
int indexOf(String str) 返回第一次出现的指定子字符串在此字符串中的索引。
int indexOf(String str, int fromIndex) 从指定的索引处开始，返回第一次出现的指定子字符串在此字符串中的索引。
int lastIndexOf(String str) 返回在此字符串中最右边出现的指定子字符串的索引。
int lastIndexOf(String str, int fromIndex) 从指定的索引处开始向后搜索，返回在此字符串中最后一次出现的指定子字符串的索引。 
int length() 返回此字符串的长度。
boolean startsWith(String prefix) 测试此字符串是否以指定的前缀开始。 
boolean startsWith(String prefix, int toffset) 测试此字符串是否以指定前缀开始，该前缀以指定索引开始。
//示例
str.Substring(0,str.LastIndexOf(","));

</pre>
</div>
</div>
<div id="outline-container-orgc0cb538" class="outline-3">
<h3 id="orgc0cb538">参考资料</h3>
<div class="outline-text-3" id="text-orgc0cb538">
<pre class="example">
http://www.blogjava.net/AndyZhang/archive/2012/04/25/376614.html
http://www.cnblogs.com/rocblog/archive/2013/05/07/3064593.html
http://www.cnblogs.com/Deckard/archive/2009/06/03/1495452.html

</pre>
</div>
</div>
</div>
<div id="outline-container-org70cb883" class="outline-2">
<h2 id="org70cb883">日期时间处理</h2>
<div class="outline-text-2" id="text-org70cb883">
</div>
<div id="outline-container-org44016ef" class="outline-3">
<h3 id="org44016ef">C#正则表达式判断输入日期格式是否正确</h3>
<div class="outline-text-3" id="text-org44016ef">
<div class="org-src-container">
<pre class="src src-emacs-lisp">/// &lt;summary&gt;
/// &#26159;&#21542;&#20026;&#26085;&#26399;&#22411;&#23383;&#31526;&#20018;
/// &lt;/summary&gt;
/// &lt;param name=<span style="color: #8b2252;">"StrSource"</span>&gt;&#26085;&#26399;&#23383;&#31526;&#20018;(2008-05-08)&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
public static bool IsDate(string StrSource)
{
     return Regex.IsMatch(StrSource, @<span style="color: #8b2252;">"^((((1[6-9]|[2-9]\d)\d{2})-(0?[13578]|1[02])-(0?[1-9]|[12]\d|3[01]))|(((1[6-9]|[2-9]\d)\d{2})-(0?[13456789]|1[012])-(0?[1-9]|[12]\d|30))|(((1[6-9]|[2-9]\d)\d{2})-0?2-(0?[1-9]|1\d|2[0-9]))|(((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))-0?2-29-))$"</span>)<span style="color: #b22222;">;</span>
}
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">/// &lt;summary&gt;
/// &#26159;&#21542;&#20026;&#26102;&#38388;&#22411;&#23383;&#31526;&#20018;
// &lt;/summary&gt;
/// &lt;param name=<span style="color: #8b2252;">"source"</span>&gt;&#26102;&#38388;&#23383;&#31526;&#20018;(15:00:00)&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
public static bool IsTime(string StrSource)
{
     return Regex.IsMatch(StrSource, @<span style="color: #8b2252;">"^((20|21|22|23|[0-1]?\d):[0-5]?\d:[0-5]?\d)$"</span>)<span style="color: #b22222;">;</span>
}
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">/// &lt;summary&gt;
/// &#26159;&#21542;&#20026;&#26085;&#26399;+&#26102;&#38388;&#22411;&#23383;&#31526;&#20018;
/// &lt;/summary&gt;
/// &lt;param name=<span style="color: #8b2252;">"source"</span>&gt;&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
public static bool IsDateTime(string StrSource)
{
    return Regex.IsMatch(StrSource, @<span style="color: #8b2252;">"^(((((1[6-9]|[2-9]\d)\d{2})-(0?[13578]|1[02])-(0?[1-9]|[12]\d|3[01]))|(((1[6-9]|[2-9]\d)\d{2})-(0?[13456789]|1[012])-(0?[1-9]|[12]\d|30))|(((1[6-9]|[2-9]\d)\d{2})-0?2-(0?[1-9]|1\d|2[0-8]))|(((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))-0?2-29-)) (20|21|22|23|[0-1]?\d):[0-5]?\d:[0-5]?\d)$ "</span>)<span style="color: #b22222;">;</span>
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgfc27e7a" class="outline-3">
<h3 id="orgfc27e7a">C#利用线程、委托，实时显示时间</h3>
<div class="outline-text-3" id="text-orgfc27e7a">
<div class="org-src-container">
<pre class="src src-emacs-lisp">#region &#36816;&#34892;&#26102;&#26174;&#31034;&#23454;&#26102;&#26102;&#38388;
new Thread(() =&gt;
{
        while (true)
        {
           try
           {
               labelTime.BeginInvoke(new MethodInvoker(() =&gt; labelTime.Text = DateTime.Now.ToString()))<span style="color: #b22222;">;</span>
           }
           catch (Exception)
           {
           }
           Thread.Sleep(1000)<span style="color: #b22222;">;</span>
         }
        })
  { IsBackground = true }.Start()<span style="color: #b22222;">;</span>
#endregion
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orged1e0dc" class="outline-2">
<h2 id="orged1e0dc">C#中无法引用自己创建的类库中的类</h2>
<div class="outline-text-2" id="text-orged1e0dc">
</div>
<div id="outline-container-org0ec1cd9" class="outline-3">
<h3 id="org0ec1cd9">问题描述</h3>
<div class="outline-text-3" id="text-org0ec1cd9">
<pre class="example">
新建一个类，定义了一些方法，在外部引用该类时，不能引用。

</pre>
</div>
</div>
<div id="outline-container-orgf5d6888" class="outline-3">
<h3 id="orgf5d6888">解决办法</h3>
<div class="outline-text-3" id="text-orgf5d6888">
<pre class="example">
1.检查类前面有没有添加加或使用public。
2.类中定义的方法也应该是public类型的
3.改完之后将该类库重新生成一次
4.注意类名不要与系统保留字冲突

</pre>
</div>
</div>
<div id="outline-container-org365965e" class="outline-3">
<h3 id="org365965e">参考资料</h3>
<div class="outline-text-3" id="text-org365965e">
<pre class="example">
https://www.ezloo.com/2008/10/classlibrary_visited.html

</pre>
</div>
</div>
</div>
<div id="outline-container-orgb4bb672" class="outline-2">
<h2 id="orgb4bb672">获取指定范围的n个随机数</h2>
<div class="outline-text-2" id="text-orgb4bb672">
<div class="org-src-container">
<pre class="src src-emacs-lisp">#region &#38543;&#26426;&#25968;&#33719;&#21462;
        /**
         * &#33719;&#21462;&#35268;&#23450;&#33539;&#22260;&#20869;&#30340;n&#20010;&#38543;&#26426;&#25968;
         * 
         * min_value    int    &#38543;&#26426;&#25968;&#19979;&#38480;
         * max_value    int    &#38543;&#26426;&#25968;&#19978;&#38480;
         * number       int    &#38543;&#26426;&#25968;&#37327;
         */
        private string getRandom(int min_value, int max_value, int number)
        {
            Random random = new Random()<span style="color: #b22222;">;</span>
            ArrayList arr = new ArrayList()<span style="color: #b22222;">;</span>
            int temp = 0<span style="color: #b22222;">;</span>
            for (int i = 0<span style="color: #b22222;">; </span><span style="color: #b22222;">i &lt; number; i++)</span>
            {
                temp = random.Next(min_value, max_value)<span style="color: #b22222;">; </span><span style="color: #b22222;">//&#38543;&#26426;&#21462;&#25968;</span>
                arr.Add(temp)<span style="color: #b22222;">;</span>
            }
            string str = <span style="color: #8b2252;">""</span><span style="color: #b22222;">;</span>
            for (int j = 0<span style="color: #b22222;">; </span><span style="color: #b22222;">j &lt; arr.Count; j++)</span>
            {
                str += arr[j].ToString() + <span style="color: #8b2252;">","</span><span style="color: #b22222;">;</span>
                //Console.Write(arr[j].ToString())<span style="color: #b22222;">;</span>
            }
            return str.Substring(0, str.LastIndexOf(<span style="color: #8b2252;">","</span>))<span style="color: #b22222;">;</span>
        }
#endregion
</pre>
</div>
</div>
</div>
<div id="outline-container-org8b14e31" class="outline-2">
<h2 id="org8b14e31">DataTable 序列化</h2>
<div class="outline-text-2" id="text-org8b14e31">
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgac56bf3">/// &lt;summary&gt;
/// &#24207;&#21015;&#21270;DataTable&#25104;XML
/// &lt;/summary&gt;
/// &lt;param name=<span style="color: #8b2252;">"dt"</span>&gt;&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
private static string SerializeDataTableToXml(DataTable dt)
{
    StringBuilder strBuilder = new StringBuilder()<span style="color: #b22222;">;</span>
    XmlWriter writer = XmlWriter.Create(strBuilder)<span style="color: #b22222;">;</span>
    XmlSerializer serializer = new XmlSerializer(typeof(DataTable))<span style="color: #b22222;">;</span>
    serializer.Serialize(writer, dt)<span style="color: #b22222;">;</span>
    writer.Close()<span style="color: #b22222;">;</span>
    return strBuilder.ToString()<span style="color: #b22222;">;</span>
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgb8be17a">/// &lt;summary&gt;
/// &#24207;&#21015;&#21270;XML&#25104;DataTable
/// &lt;/summary&gt;
/// &lt;param name=<span style="color: #8b2252;">"xml"</span>&gt;&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
private static DataTable SerializeXmlToDataTable(string xml)
{
    StringReader strReader = new StringReader(xml)<span style="color: #b22222;">;</span>
    XmlReader xmlReader = XmlReader.Create(strReader)<span style="color: #b22222;">;</span>
    XmlSerializer serializer = new XmlSerializer(typeof(DataTable))<span style="color: #b22222;">;</span>
    DataTable dt = serializer.Deserialize(xmlReader) as DataTable<span style="color: #b22222;">;</span>
    return dt<span style="color: #b22222;">;</span>
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org48c102c">DMWebSvrSoapClient dmwss = new DMWebSvrSoapClient()<span style="color: #b22222;">;</span>
DateTime date = DateTime.Now<span style="color: #b22222;">;</span>
string dataStr1 = dmwss.GetVehicleInfo_Month(date.ToString(<span style="color: #8b2252;">"yyyy-MM-dd"</span>))<span style="color: #b22222;">;</span>

XmlDocument xmldoc = new XmlDocument()<span style="color: #b22222;">;</span>
xmldoc.LoadXml(dataStr1)<span style="color: #b22222;">;</span>
XmlNodeList xnList = xmldoc.SelectNodes(<span style="color: #8b2252;">"//DocumentElement/list"</span>)<span style="color: #b22222;">;</span>
foreach (XmlNode xn in xnList)
{
     ListViewItem item = new ListViewItem(xn[<span style="color: #8b2252;">"time"</span>].InnerText)<span style="color: #b22222;">;</span>
     item.SubItems.Add(xn[<span style="color: #8b2252;">"in_vehicle_count"</span>].InnerText)<span style="color: #b22222;">;</span>
     item.SubItems.Add(xn[<span style="color: #8b2252;">"out_vehicle_count"</span>].InnerText)<span style="color: #b22222;">;</span>
     listView.Items.Add(item)<span style="color: #b22222;">;</span>
}
</pre>
</div>
</div>
<div id="outline-container-orgaa63d90" class="outline-3">
<h3 id="orgaa63d90">参考资料</h3>
<div class="outline-text-3" id="text-orgaa63d90">
<pre class="example">
http://stackoverflow.com/questions/6402596/xml-string-to-xml-document
https://zhidao.baidu.com/question/574030822.html
https://msdn.microsoft.com/en-us/library/hcebdtae(v=vs.110).aspx

</pre>
</div>
</div>
</div>
